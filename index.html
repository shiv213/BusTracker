<!DOCTYPE html>
<html lang="en">
<head>
    <title>BusTracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css"
          integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous">
    <link rel="stylesheet" href="table.css"/>
    <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
</head>
<body>
<h1 style="text-align: center; margin-bottom: 5px;">BusTracker</h1>
<!--<div class="draggable"> Draggable Element</div>-->
<div class="divTable" style="margin: 0 auto; text-align: center; width: 99%; border: 1px solid #000;">
    <div class="divTableBody">
        <div class="divTableRow" style="font-size: 50%; color: gray; height: 5%">
            <div class="divTableCell">Lane 1
            </div>
            <div class="divTableCell">Lane 2
            </div>
            <div class="divTableCell">Lane 3
            </div>
            <div class="divTableCell">Lane 4
            </div>
        </div>
        <div class="divTableRow" style="height: 5%">
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
        </div>
        <div class="divTableRow" style="height: 5%">
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
        </div>
        <div class="divTableRow" style="height: 5%">
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
        </div>
        <div class="divTableRow" style="height: 5%">
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
        </div>
        <div class="divTableRow" style="height: 5%">
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
        </div>
        <div class="divTableRow" style="height: 5%">
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
<!--                 <div class="draggable">1234</div> -->
            </div>
        </div>
        <div class="divTableRow" style="height: 5%">
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
<!--                 <div class="draggable">1234</div> -->
            </div>
        </div>
        <div class="divTableRow" style="height: 5%">
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
<!--                 <div class="draggable">1234</div> -->
            </div>
            <div class="divTableCell">
                <div class="draggable">1234</div>
            </div>
            <div class="divTableCell">
<!--                 <div class="draggable">1234</div> -->
            </div>
        </div>
    </div>
</div>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<!--<script src="/__/firebase/6.6.1/firebase-app.js"></script>-->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.6.1/firebase-database.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
https://firebase.google.com/docs/web/setup#reserved-urls -->
<!--<script src="/__/firebase/init.js"></script>-->
<script src="https://unpkg.com/interactjs/dist/interact.min.js"></script>
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyD9eBYKEv4Oxd77lic4B6ecJHnlCd52GPY",
        authDomain: "bustracker-nhs.firebaseapp.com",
        databaseURL: "https://bustracker-nhs.firebaseio.com",
        projectId: "bustracker-nhs",
        storageBucket: "bustracker-nhs.appspot.com",
        messagingSenderId: "103544439176",
        appId: "1:103544439176:web:a0b0fee8fff6dc10f57a3d",
        measurementId: "G-Y117NQCTVX"
    };

    // // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    const position = {
        x: 0,
        y: 0
    };
    var width = document.querySelector("div.divTableCell").offsetWidth;
    var height = document.querySelector("div.divTableCell").offsetHeight;
    // var element = document.getElementById('grid-snap');
    // var element = document.getElementsByClassName('draggable')[0];

    var x = 0;
    var y = 0;
    document.querySelectorAll(".draggable").forEach(element => {
        interact(element).draggable({
            modifiers: [interact.modifiers.snap({
                targets: [interact.createSnapGrid({
                    x: width,
                    y: height
                })],
                range: Infinity,
                relativePoints: [{
                    x: 0,
                    y: 0
                }],
                offset: 'self',
                limits: {
                    top: 0,
                    left: 0,
                    bottom: 0,
                    height: 0
                }
            }), interact.modifiers.restrict({
                restriction: document.getElementsByClassName('draggable')[0].parentNode.parentNode.parentNode,
                elementRect: {
                    top: 0,
                    left: 0,
                    bottom: 1,
                    right: 1
                },
                endOnly: true
            })],
            inertia: true,
            onmove: dragMoveListener,
            onend: function (event) {
                console.log('moved a distance of ' +
                    (Math.sqrt(Math.pow(event.pageX - event.x0, 2) +
                        Math.pow(event.pageY - event.y0, 2) | 0))
                        .toFixed(2) + 'px');
            }
        });

        function dragMoveListener(event) {
            var target = event.target;
            // keep the dragged position in the data-x/data-y attributes
            var x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
            var y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

            // translate the element
            target.style.webkitTransform =
                target.style.transform =
                    'translate(' + x + 'px, ' + y + 'px)';

            // update the posiion attributes
            target.setAttribute('data-x', x);
            target.setAttribute('data-y', y);
        }

//         this is used later in the resizing and gesture demos
//         window.dragMoveListener = dragMoveListener;

        var gridTarget = interact.createSnapGrid({
            // can be a pair of x and y, left and top,
            // right and bottom, or width, and height
            x: width,
            y: height,

            // optional
            range: 40,

            // optional
            offset: {
                x: 0,
                y: 0
            },

            // optional
            limits: {
                top: 0,
                left: 0,
                bottom: 500,
                height: 500
            }
        });
    })

</script>
</body>
</html>
